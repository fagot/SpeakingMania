@{  
    ViewBag.Title = "Home Page";
}
<div class="row well">
    <h4>@ViewBag.Message</h4>
    <span>Logined as: </span>
    <h4 id="userName"></h4>
</div>
          
<div class="row well mainBlock">
    <div class="span2 well-small usersBlock">
        <p class="text-info">Users online:</p> 
        <ul id="users" class="unstyled">
        </ul>
    </div>
    
    <div class="span9">
        <div class="well roomsBlock">
            <table id="rooms" class="table">

            </table>
        </div>
            <button class="btn btn-success" type="submit" onclick="CreateRoomDialog()">Create a new room</button>
    </div>
</div>

<div class="modal fade" id="login_modal">
    <div class="modal-header">
        <h3>Please fill the form</h3>
    </div>
    <div id="modal_content" class="modal-body">
        @using (Ajax.BeginForm("Login", null, new AjaxOptions { HttpMethod = "POST", OnSuccess = "Login" }, new { Class = "form-search" }))
        {
            <input id="login" name="login" class="input-xlarge" type="text" placeholder="Your name" />
            <span id="login-error" class="help-inline error" style="display: none;"></span>

            <button class="btn btn-success" type="submit">Login</button>
        }
    </div>
    <div class="modal-footer">
    </div>
</div>
@* Room creating modal dialog *@
<div class="modal fade" id="new_room_modal">
    <div class="modal-header">
        <h3>Please fill the form</h3>
    </div>
    <div id="modal_content" class="modal-body">
        @using (Ajax.BeginForm("JoinRoom", null, new AjaxOptions { HttpMethod = "POST", OnSuccess = "CreateRoom" }, new { Class = "form-search" }))
        {
            <div class="control-group" id="roomForm">
                <input id="roomName" name="roomName" class="input-xlarge" type="text" placeholder="The name of the room" />
                <button class="btn btn-primary" type="submit">Open room</button>
                <span id="room-error" class="help-inline text-error" style="display: none;"></span>
                <input type="hidden" id="userId" name="userId" value="@ViewBag.UserId"/>
            </div>
        }
    </div>
    <div class="modal-footer">
    </div>
</div>
@* Room joining modal dialog *@
<div class="modal fade" id="join_room_modal">
    <div class="modal-header">
        <h3>Join the room!</h3>
    </div>
    <div id="modal_content" class="modal-body">
        @using (Ajax.BeginForm("JoinRoom", null, new AjaxOptions { HttpMethod = "POST", OnSuccess = "CreateRoom" }, new { Class = "form-search" }))
        {
            <div class="control-group" id="joinRoomForm">
                <h4>Room name: </h4>
                <label id="lbl_roomName"></label><br/>
                <input type="hidden" id="roomKey" name="roomKey" />
                <button class="btn btn-primary" type="submit">Join the room</button>
                <span id="join-room-error" class="help-inline text-error" style="display: none;"></span>
                <input type="hidden" id="joinUserId" name="userId" value="@ViewBag.UserId"/>
            </div>
        }
    </div>
    <div class="modal-footer">
    </div>
</div>
@section scripts
{    
    @Scripts.Render("~/Scripts/app/main.js")

    @if (ViewBag.Login != null && !String.IsNullOrEmpty(ViewBag.Login.ToString()))
    {
        <script type="text/javascript"> Login({ success: true, name: '@ViewBag.Login' }); </script>
    }
    else
    {
        <script type="text/javascript"> SetNameDialog(); </script>
    }
}
